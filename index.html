<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Escandallo de CÃ³cteles</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
body { 
    font-family: 'Roboto', sans-serif; 
    background: #f4f6f8; 
    margin:0; padding:0; 
    color: #2c3e50;
}

.container { 
    max-width: 1000px; 
    margin: 30px auto; 
    padding: 30px; 
    background: #fff; 
    border-radius: 15px; 
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

header h1 { 
    text-align: center; 
    color: #34495e; 
    font-weight: 700; 
    font-size: 2.5em; 
    margin-bottom: 30px;
}

/* Grid para inputs */
.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}
.form-grid label { margin-top: 0; }
.form-grid input { 
    width: 100%; 
    padding: 10px; 
    border-radius: 8px; 
    border: 1px solid #bdc3c7; 
    background: #ecf0f1; 
    font-size: 16px; 
    transition: 0.2s; 
}
.form-grid input:focus { 
    border-color: #2980b9; 
    box-shadow: 0 0 5px rgba(41,128,185,0.3); 
    background: #fff; 
}

/* Botones */
.buttons {
    display: flex; 
    gap: 15px; 
    margin-top: 15px;
    flex-wrap: wrap;
}
button { 
    flex: 1; 
    cursor: pointer; 
    font-weight: 700; 
    transition: 0.3s; 
    border: none; 
    border-radius: 8px; 
    padding: 12px;
    font-size: 16px;
    color: #fff;
}
button.add { background-color: #2980b9; }
button.add:hover { background-color: #1f6391; }
button.edit { background-color: #f39c12; }
button.edit:hover { background-color: #d68910; }
button.delete { background-color: #e74c3c; }
button.delete:hover { background-color: #c0392b; }
button.pdf { background-color: #27ae60; }
button.pdf:hover { background-color: #1e8449; }

/* Tablas tipo Excel */
table { 
    width: 100%; 
    margin-top: 25px; 
    border-collapse: collapse; 
    font-family: Arial, sans-serif; 
    text-align: center;
}
th, td { 
    padding: 12px; 
    border: 1px solid #bdc3c7; 
}
th { background-color: #2980b9; color: #fff; font-weight: 600; }
tr:nth-child(even){ background-color: #ecf0f1; }
tr:hover { background-color: #dfe6e9; }

/* Aviso de donaciÃ³n */
.donation-box {
    margin-top: 30px; 
    padding: 15px; 
    background-color: #f1c40f; 
    color: #2c3e50; 
    border-radius: 8px; 
    text-align: center; 
    font-weight: 500;
}
.donation-box a {
    color:#2980b9; 
    text-decoration:underline;
}

footer { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-top: 40px; 
    font-size: 14px; 
    color: #7f8c8d; 
}

@media(max-width:768px){ 
    .form-grid { grid-template-columns: 1fr; }
    input, button { font-size:14px; padding:10px;} 
    th, td { font-size:14px; padding:10px;} 
    .buttons { flex-direction: column; }
    footer { flex-direction: column; gap: 5px; }
}
</style>
</head>
<body>

<section class="container" id="escandallo">
    <header>
        <h1>Escandallo de CÃ³cteles</h1>
    </header>

    <div class="form-grid">
        <div>
            <label for="cocktailName">Nombre del cÃ³ctel:</label>
            <input type="text" id="cocktailName" placeholder="Ej: Mojito">
        </div>
        <div>
            <label for="servings">NÃºmero de porciones:</label>
            <input type="number" id="servings" value="1" min="1" onchange="calculateTotal()">
        </div>
        <div>
            <label for="ingredient">Ingrediente:</label>
            <input type="text" id="ingredient" placeholder="Ej: Ron blanco">
        </div>
        <div>
            <label for="quantity">Cantidad (ml):</label>
            <input type="number" id="quantity" placeholder="Ej: 50" min="1">
        </div>
        <div>
            <label for="bottleVolume">Volumen de la botella (cl):</label>
            <input type="number" id="bottleVolume" placeholder="Ej: 70" min="1">
        </div>
        <div>
            <label for="bottleCost">Costo de la botella (â‚¬):</label>
            <input type="number" id="bottleCost" placeholder="Ej: 15.00" step="0.01">
        </div>
    </div>

    <div class="buttons">
        <button class="add" onclick="addIngredient()">Agregar Ingrediente</button>
        <button class="pdf" onclick="exportPDF()">ðŸ“„ Exportar a PDF</button>
    </div>

    <!-- Tabla tipo Excel ingredientes -->
    <table id="ingredientsTable">
        <thead>
            <tr>
                <th>Ingrediente</th>
                <th>Cantidad (ml)</th>
                <th>Volumen Botella (cl)</th>
                <th>Costo Botella (â‚¬)</th>
                <th>Costo Proporcional (â‚¬)</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Tabla tipo Excel resultados -->
    <table id="resultTable">
        <thead>
            <tr>
                <th>Costo total del cÃ³ctel (â‚¬)</th>
                <th>Costo por porciÃ³n (â‚¬)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="totalCost">0.00</td>
                <td id="costPerServing">0.00</td>
            </tr>
        </tbody>
    </table>

    <!-- Aviso de donaciÃ³n -->
    <div class="donation-box">
        Si esta herramienta te resulta Ãºtil, considera apoyarnos con una 
        <a href="https://www.paypal.com/donate" target="_blank">donaciÃ³n</a>. Â¡Tu apoyo nos ayuda a mejorar!
    </div>

</section>

<footer>
    &copy; 2025
    <span>â€” Escandallo creado por CÃ©sar Requejo</span>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<script>
let ingredients = [];

function addIngredient() {
    const ingredient = document.getElementById('ingredient').value.trim();
    const quantity = parseFloat(document.getElementById('quantity').value);
    const bottleVolumeCl = parseFloat(document.getElementById('bottleVolume').value);
    const bottleCost = parseFloat(document.getElementById('bottleCost').value);

    if(!ingredient || isNaN(quantity) || isNaN(bottleVolumeCl) || isNaN(bottleCost) || quantity<=0 || bottleVolumeCl<=0 || bottleCost<0) {
        alert("Completa todos los campos correctamente y con valores vÃ¡lidos");
        return;
    }

    const bottleVolumeMl = bottleVolumeCl * 10;
    const costPerMl = bottleCost / bottleVolumeMl;
    const total = parseFloat((quantity * costPerMl).toFixed(2));

    ingredients.push({ingredient, quantity, bottleVolumeCl, bottleCost, total});
    renderTable();
    calculateTotal();

    document.getElementById('ingredient').value = '';
    document.getElementById('quantity').value = '';
    document.getElementById('bottleVolume').value = '';
    document.getElementById('bottleCost').value = '';
}

function renderTable() {
    const tbody = document.querySelector('#ingredientsTable tbody');
    tbody.innerHTML = '';
    ingredients.forEach((item,index)=>{
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${item.ingredient}</td>
            <td>${item.quantity}</td>
            <td>${item.bottleVolumeCl}</td>
            <td>â‚¬${item.bottleCost.toFixed(2)}</td>
            <td>â‚¬${item.total.toFixed(2)}</td>
            <td>
                <button class="edit" onclick="editIngredient(${index})">Editar</button>
                <button class="delete" onclick="removeIngredient(${index})">Eliminar</button>
            </td>
        `;
        tbody.appendChild(row);
    });
}

function calculateTotal() {
    const total = ingredients.reduce((sum, item) => sum + item.total, 0);
    const servings = parseInt(document.getElementById('servings').value) || 1;
    document.getElementById('totalCost').innerText = total.toFixed(2);
    document.getElementById('costPerServing').innerText = (total/servings).toFixed(2);
}

function editIngredient(index) {
    const item = ingredients[index];
    document.getElementById('ingredient').value = item.ingredient;
    document.getElementById('quantity').value = item.quantity;
    document.getElementById('bottleVolume').value = item.bottleVolumeCl;
    document.getElementById('bottleCost').value = item.bottleCost;

    ingredients.splice(index,1);
    renderTable();
    calculateTotal();
}

function removeIngredient(index) {
    ingredients.splice(index,1);
    renderTable();
    calculateTotal();
}

function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const cocktailName = document.getElementById('cocktailName').value || "CÃ³ctel";
    const today = new Date();
    const dateStr = today.toLocaleDateString();

    doc.setFontSize(18);
    doc.text("Escandallo de CÃ³cteles", 105, 20, null, null, "center");

    doc.setFontSize(12);
    doc.text(`Nombre: ${cocktailName}`, 15, 30);
    doc.text(`Fecha: ${dateStr}`, 150, 30);

    const tableData = ingredients.map(item => [
        item.ingredient,
        item.quantity,
        item.bottleVolumeCl,
        item.bottleCost.toFixed(2),
        item.total.toFixed(2)
    ]);

    const tableColumns = [
        'Ingrediente', 'Cantidad (ml)', 'Volumen Botella (cl)', 'Costo Botella (â‚¬)', 'Costo Proporcional (â‚¬)'
    ];

    doc.autoTable({
        startY: 40,
        head: [tableColumns],
        body: tableData,
        styles: { halign: 'center', valign: 'middle', fontSize: 10 },
        headStyles: { fillColor: [41, 128, 185], textColor: 255, fontStyle: 'bold' },
        alternateRowStyles: { fillColor: [245, 245, 245] },
        margin: { left: 15, right: 15 }
    });

    const total = ingredients.reduce((sum, item) => sum + item.total, 0);
    const servings = parseInt(document.getElementById('servings').value) || 1;
    let finalY = doc.lastAutoTable.finalY + 10;
    doc.setFontSize(12);
    doc.text(`Costo total: â‚¬${total.toFixed(2)}`, 15, finalY);
    doc.text(`Costo por porciÃ³n: â‚¬${(total/servings).toFixed(2)}`, 150, finalY);
    finalY += 10;
    doc.text("Escandallo realizado por: ____________________________", 15, finalY);
    finalY += 25;
    doc.text("Firma: ____________________________", 15, finalY);

    doc.save(`${cocktailName}_Escandallo.pdf`);
}
</script>

</body>
</html>




